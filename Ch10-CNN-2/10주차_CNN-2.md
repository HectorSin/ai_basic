# LAB 9-2 í•©ì„±ê³± ì‹ ê²½ë§ìœ¼ë¡œ íŒ¨ì…˜ MNIST ë¶„ë¥˜ë¥¼ ê°œì„ í•˜ê¸°
***
### ì‹¤ìŠµ ëª©í‘œ
> CNNì„ ì´ìš©í•˜ì—¬ íŒ¨ì…˜ MNIST ë°ì´í„°ë¥¼ ë¶„ë¥˜í•˜ëŠ” ì‘ì—…ì„ ì‹œë„í•˜ì. ì´ ë°©ë²•ê³¼ ë‹¤ì¸µ í¼ì…‰íŠ¸ë¡ ì„ ì‚¬ìš©í•œ ë°©ë²•ì„ ë¹„êµí•˜ê³ , ì–¼ë§ˆë‚˜ ì„±ëŠ¥ì´ ê°œì„ ë˜ëŠ”ì§€ í™•ì¸í•´ ë³´ì
***


```python
#!pip install tensorflow
```

    Collecting tensorflow
      Downloading tensorflow-2.11.0-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (588.3 MB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 588.3 MB 46 kB/s  eta 0:00:01    |â–ˆâ–ˆ                              | 37.6 MB 6.1 MB/s eta 0:01:30     |â–ˆâ–ˆâ–ˆâ–‹                            | 67.3 MB 7.8 MB/s eta 0:01:07     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–                          | 96.2 MB 5.4 MB/s eta 0:01:32     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–                       | 149.5 MB 6.2 MB/s eta 0:01:11     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–               | 300.3 MB 6.2 MB/s eta 0:00:47     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š               | 308.1 MB 6.2 MB/s eta 0:00:45     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–              | 318.8 MB 6.2 MB/s eta 0:00:44     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š              | 326.6 MB 5.3 MB/s eta 0:00:50     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ              | 332.5 MB 6.2 MB/s eta 0:00:42     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–            | 354.6 MB 6.2 MB/s eta 0:00:38     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–       | 447.4 MB 6.1 MB/s eta 0:00:23     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–      | 464.1 MB 5.4 MB/s eta 0:00:24     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 510.7 MB 5.4 MB/s eta 0:00:15     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 541.8 MB 5.8 MB/s eta 0:00:08
    [?25hRequirement already satisfied: typing-extensions>=3.6.6 in /opt/conda/lib/python3.8/site-packages (from tensorflow) (3.7.4.3)
    Requirement already satisfied: protobuf<3.20,>=3.9.2 in /opt/conda/lib/python3.8/site-packages (from tensorflow) (3.14.0)
    Requirement already satisfied: packaging in /opt/conda/lib/python3.8/site-packages (from tensorflow) (20.8)
    Requirement already satisfied: setuptools in /opt/conda/lib/python3.8/site-packages (from tensorflow) (49.6.0.post20210108)
    Requirement already satisfied: six>=1.12.0 in /opt/conda/lib/python3.8/site-packages (from tensorflow) (1.15.0)
    Requirement already satisfied: h5py>=2.9.0 in /opt/conda/lib/python3.8/site-packages (from tensorflow) (3.1.0)
    Collecting absl-py>=1.0.0
      Downloading absl_py-1.3.0-py3-none-any.whl (124 kB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 124 kB 6.0 MB/s eta 0:00:01
    [?25hCollecting astunparse>=1.6.0
      Downloading astunparse-1.6.3-py2.py3-none-any.whl (12 kB)
    Requirement already satisfied: wheel<1.0,>=0.23.0 in /opt/conda/lib/python3.8/site-packages (from astunparse>=1.6.0->tensorflow) (0.36.2)
    Collecting flatbuffers>=2.0
      Downloading flatbuffers-22.10.26-py2.py3-none-any.whl (26 kB)
    Collecting gast<=0.4.0,>=0.2.1
      Downloading gast-0.4.0-py3-none-any.whl (9.8 kB)
    Collecting google-pasta>=0.1.1
      Downloading google_pasta-0.2.0-py3-none-any.whl (57 kB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 57 kB 5.3 MB/s eta 0:00:011
    [?25hCollecting grpcio<2.0,>=1.24.3
      Downloading grpcio-1.50.0-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (4.7 MB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4.7 MB 6.2 MB/s eta 0:00:01
    [?25hCollecting keras<2.12,>=2.11.0
      Downloading keras-2.11.0-py2.py3-none-any.whl (1.7 MB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1.7 MB 6.0 MB/s eta 0:00:01
    [?25hCollecting libclang>=13.0.0
      Downloading libclang-14.0.6-py2.py3-none-manylinux2010_x86_64.whl (14.1 MB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 14.1 MB 5.3 MB/s eta 0:00:01    |â–ˆâ–ˆâ–ˆâ–‹                            | 1.6 MB 6.1 MB/s eta 0:00:03     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 12.1 MB 5.3 MB/s eta 0:00:01
    [?25hCollecting numpy>=1.20
      Downloading numpy-1.23.5-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (17.1 MB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 17.1 MB 4.7 MB/s eta 0:00:01    |â–ˆâ–ˆâ–ˆâ–ˆâ–                           | 2.3 MB 6.0 MB/s eta 0:00:03     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰             | 10.0 MB 6.2 MB/s eta 0:00:02     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š         | 12.1 MB 4.7 MB/s eta 0:00:02
    [?25hCollecting opt-einsum>=2.3.2
      Downloading opt_einsum-3.3.0-py3-none-any.whl (65 kB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 65 kB 4.4 MB/s eta 0:00:01
    [?25hCollecting tensorboard<2.12,>=2.11
      Downloading tensorboard-2.11.0-py3-none-any.whl (6.0 MB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6.0 MB 3.2 MB/s eta 0:00:01
    [?25hRequirement already satisfied: requests<3,>=2.21.0 in /opt/conda/lib/python3.8/site-packages (from tensorboard<2.12,>=2.11->tensorflow) (2.25.1)
    Collecting google-auth<3,>=1.6.3
      Downloading google_auth-2.14.1-py2.py3-none-any.whl (175 kB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 175 kB 6.1 MB/s eta 0:00:01
    [?25hCollecting cachetools<6.0,>=2.0.0
      Downloading cachetools-5.2.0-py3-none-any.whl (9.3 kB)
    Collecting google-auth-oauthlib<0.5,>=0.4.1
      Downloading google_auth_oauthlib-0.4.6-py2.py3-none-any.whl (18 kB)
    Collecting markdown>=2.6.8
      Downloading Markdown-3.4.1-py3-none-any.whl (93 kB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 93 kB 3.0 MB/s eta 0:00:01
    [?25hCollecting importlib-metadata>=4.4
      Downloading importlib_metadata-5.0.0-py3-none-any.whl (21 kB)
    Requirement already satisfied: zipp>=0.5 in /opt/conda/lib/python3.8/site-packages (from importlib-metadata>=4.4->markdown>=2.6.8->tensorboard<2.12,>=2.11->tensorflow) (3.4.0)
    Collecting pyasn1-modules>=0.2.1
      Downloading pyasn1_modules-0.2.8-py2.py3-none-any.whl (155 kB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 155 kB 5.9 MB/s eta 0:00:01
    [?25hCollecting pyasn1<0.5.0,>=0.4.6
      Downloading pyasn1-0.4.8-py2.py3-none-any.whl (77 kB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 77 kB 4.9 MB/s eta 0:00:01
    [?25hRequirement already satisfied: chardet<5,>=3.0.2 in /opt/conda/lib/python3.8/site-packages (from requests<3,>=2.21.0->tensorboard<2.12,>=2.11->tensorflow) (4.0.0)
    Requirement already satisfied: idna<3,>=2.5 in /opt/conda/lib/python3.8/site-packages (from requests<3,>=2.21.0->tensorboard<2.12,>=2.11->tensorflow) (2.10)
    Requirement already satisfied: urllib3<1.27,>=1.21.1 in /opt/conda/lib/python3.8/site-packages (from requests<3,>=2.21.0->tensorboard<2.12,>=2.11->tensorflow) (1.26.2)
    Requirement already satisfied: certifi>=2017.4.17 in /opt/conda/lib/python3.8/site-packages (from requests<3,>=2.21.0->tensorboard<2.12,>=2.11->tensorflow) (2020.12.5)
    Collecting requests-oauthlib>=0.7.0
      Downloading requests_oauthlib-1.3.1-py2.py3-none-any.whl (23 kB)
    Requirement already satisfied: oauthlib>=3.0.0 in /opt/conda/lib/python3.8/site-packages (from requests-oauthlib>=0.7.0->google-auth-oauthlib<0.5,>=0.4.1->tensorboard<2.12,>=2.11->tensorflow) (3.0.1)
    Collecting rsa<5,>=3.1.4
      Downloading rsa-4.9-py3-none-any.whl (34 kB)
    Collecting tensorboard-data-server<0.7.0,>=0.6.0
      Downloading tensorboard_data_server-0.6.1-py3-none-manylinux2010_x86_64.whl (4.9 MB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4.9 MB 6.1 MB/s eta 0:00:01
    [?25hCollecting tensorboard-plugin-wit>=1.6.0
      Downloading tensorboard_plugin_wit-1.8.1-py3-none-any.whl (781 kB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 781 kB 5.8 MB/s eta 0:00:01
    [?25hCollecting tensorflow-estimator<2.12,>=2.11.0
      Downloading tensorflow_estimator-2.11.0-py2.py3-none-any.whl (439 kB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 439 kB 5.7 MB/s eta 0:00:01
    [?25hCollecting tensorflow-io-gcs-filesystem>=0.23.1
      Downloading tensorflow_io_gcs_filesystem-0.28.0-cp38-cp38-manylinux_2_12_x86_64.manylinux2010_x86_64.whl (2.4 MB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2.4 MB 5.8 MB/s eta 0:00:01
    [?25hCollecting termcolor>=1.1.0
      Downloading termcolor-2.1.1-py3-none-any.whl (6.2 kB)
    Collecting werkzeug>=1.0.1
      Downloading Werkzeug-2.2.2-py3-none-any.whl (232 kB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 232 kB 5.8 MB/s eta 0:00:01
    [?25hCollecting MarkupSafe>=2.1.1
      Downloading MarkupSafe-2.1.1-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (25 kB)
    Collecting wrapt>=1.11.0
      Downloading wrapt-1.14.1-cp38-cp38-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (81 kB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 81 kB 6.3 MB/s eta 0:00:011
    [?25hRequirement already satisfied: pyparsing>=2.0.2 in /opt/conda/lib/python3.8/site-packages (from packaging->tensorflow) (2.4.7)
    Installing collected packages: pyasn1, rsa, pyasn1-modules, cachetools, requests-oauthlib, MarkupSafe, importlib-metadata, google-auth, werkzeug, tensorboard-plugin-wit, tensorboard-data-server, numpy, markdown, grpcio, google-auth-oauthlib, absl-py, wrapt, termcolor, tensorflow-io-gcs-filesystem, tensorflow-estimator, tensorboard, opt-einsum, libclang, keras, google-pasta, gast, flatbuffers, astunparse, tensorflow
      Attempting uninstall: MarkupSafe
        Found existing installation: MarkupSafe 1.1.1
        Uninstalling MarkupSafe-1.1.1:
          Successfully uninstalled MarkupSafe-1.1.1
      Attempting uninstall: importlib-metadata
        Found existing installation: importlib-metadata 3.4.0
        Uninstalling importlib-metadata-3.4.0:
          Successfully uninstalled importlib-metadata-3.4.0
      Attempting uninstall: numpy
        Found existing installation: numpy 1.19.5
        Uninstalling numpy-1.19.5:
          Successfully uninstalled numpy-1.19.5
    Successfully installed MarkupSafe-2.1.1 absl-py-1.3.0 astunparse-1.6.3 cachetools-5.2.0 flatbuffers-22.10.26 gast-0.4.0 google-auth-2.14.1 google-auth-oauthlib-0.4.6 google-pasta-0.2.0 grpcio-1.50.0 importlib-metadata-5.0.0 keras-2.11.0 libclang-14.0.6 markdown-3.4.1 numpy-1.23.5 opt-einsum-3.3.0 pyasn1-0.4.8 pyasn1-modules-0.2.8 requests-oauthlib-1.3.1 rsa-4.9 tensorboard-2.11.0 tensorboard-data-server-0.6.1 tensorboard-plugin-wit-1.8.1 tensorflow-2.11.0 tensorflow-estimator-2.11.0 tensorflow-io-gcs-filesystem-0.28.0 termcolor-2.1.1 werkzeug-2.2.2 wrapt-1.14.1



```python
# íŒ¨í‚¤ì§€ì™€ ë°ì´í„° ì¤€ë¹„
import tensorflow as tf
from tensorflow import keras
import numpy as np
import matplotlib.pyplot as plt

# íŒ¨ì…˜ MNIST ë°ì´í„°ë¥¼ í•™ìŠµìš© ë°ì´í„°, í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¡œ êµ¬ë¶„
fashion_mnist = keras.datasets.fashion_mnist
(train_images, train_labels), (test_images, test_labels) = fashion_mnist.load_data()
```

    Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/train-labels-idx1-ubyte.gz
    29515/29515 [==============================] - 0s 1us/step
    Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/train-images-idx3-ubyte.gz
    26421880/26421880 [==============================] - 5s 0us/step
    Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/t10k-labels-idx1-ubyte.gz
    5148/5148 [==============================] - 0s 0us/step
    Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/t10k-images-idx3-ubyte.gz
    4422102/4422102 [==============================] - 1s 0us/step



```python
# í•™ìŠµ ì´ë¯¸ì§€ í˜•íƒœ ì¶œë ¥
print(train_images.shape)
# í•™ìŠµ ë ˆì´ë¸” ì¶œë ¥
print(train_labels)
# í…ŒìŠ¤íŠ¸ ì´ë¯¸ì§€ í˜•íƒœ ì¶œë ¥
print(test_images.shape)
```

    (60000, 28, 28)
    [9 0 0 ... 3 0 5]
    (10000, 28, 28)



```python
# ì´ë¯¸ì§€ì˜ ì±„ë„ì˜ ê°œìˆ˜ì— ë”°ë¼ í‘ìƒ‰ì¡°, ìƒ‰ê° ë“±ë“± ì´ë¯¸ì§€ì˜ í˜•íƒœê°€ ë‚˜ë‰œë‹¤
# mnistë°ì´í„° ì…‹ì˜ ì´ë¯¸ì§€ëŠ” í‘ìƒ‰ì¡°ì´ê¸°ì— ì±„ë„ ì •ë³´ê°€ ì—†ë‹¤
# ì°¨ì› ìˆ˜ë¥¼ ëŠ˜ë¦¬ëŠ”ë° ìì£¼ ì‚¬ìš©í•˜ëŠ” ë„˜íŒŒì´ì˜ newaxisë¥¼ í™œìš©í•˜ì—¬ ë§ˆì§€ë§‰ ì— ì°¨ì›ì„ ì±„ì›Œì¤€ë‹¤
train_images = train_images[:, :, :, np.newaxis]
test_images = test_images[:, :, :, np.newaxis]
```


```python
# ì¼€ë¼ìŠ¤ì˜ Sequential í´ë˜ìŠ¤ì— ê³„ì¸µì„ ìŒ“ê¸°
model = keras.models.Sequential([
    # 28*28 ì…ë ¥ì¸µì„ í†µí•´ 28*28 32ì¥ Conv2D
    keras.layers.Conv2D(input_shape = (28, 28, 1),
                       kernel_size = (3,3), padding = 'same',
                       filters = 32),
    # 14*14 32ì¥ MaxPooling
    keras.layers.MaxPooling2D((2, 2), strides=2),
    # 14*14 64ì¥ Conv2D
    keras.layers.Conv2D(kernel_size = (3,3), padding ='same',
                       filters = 64),
    # 7*7 64ì¥ MaxPooling
    keras.layers.MaxPooling2D((2, 2), strides=2),
    # 7*7 32ì¥ Conv2D
    keras.layers.Conv2D(kernel_size = (3,3), padding ='same',
                       filters = 32),
    # 1568ê°œì˜ ë°ì´í„°ë¡œ flattení™”
    keras.layers.Flatten(),
    # ë°€ì§‘ì—°ê²° reluí™œìš©
    keras.layers.Dense(128, activation = 'relu'),
    # ë°€ì§‘ì—°ê²° reluí™œìš©
    keras.layers.Dense(32, activation = 'relu'),
    # 10ê°œì˜ ë…¸íŠ¸ Softmax ì¶œë ¥
    keras.layers.Dense(10, activation = 'softmax')
])
```


```python
model.summary()
```

    Model: "sequential"
    _________________________________________________________________
     Layer (type)                Output Shape              Param #   
    =================================================================
     conv2d (Conv2D)             (None, 28, 28, 32)        320       
                                                                     
     max_pooling2d (MaxPooling2D  (None, 14, 14, 32)       0         
     )                                                               
                                                                     
     conv2d_1 (Conv2D)           (None, 14, 14, 64)        18496     
                                                                     
     max_pooling2d_1 (MaxPooling  (None, 7, 7, 64)         0         
     2D)                                                             
                                                                     
     conv2d_2 (Conv2D)           (None, 7, 7, 32)          18464     
                                                                     
     flatten (Flatten)           (None, 1568)              0         
                                                                     
     dense (Dense)               (None, 128)               200832    
                                                                     
     dense_1 (Dense)             (None, 32)                4128      
                                                                     
     dense_2 (Dense)             (None, 10)                330       
                                                                     
    =================================================================
    Total params: 242,570
    Trainable params: 242,570
    Non-trainable params: 0
    _________________________________________________________________



```python
# ëª¨ë¸ ì»´íŒŒì¼ í›„ í•™ìŠµ
model.compile(optimizer='adam',
             loss='sparse_categorical_crossentropy',
             metrics=['accuracy'])
# í•™ìŠµì— ê³¼ì •ì—ì„œ ì†ì‹¤ ê°’ê³¼ ì •í™•ë„ historyì— ê¸°ë¡ (15 ì—í­, 25% ê²€ì¦ì— ì‚¬ìš©)
history = model.fit(train_images, train_labels,
                   epochs=15, validation_split=0.25)
```

    Epoch 1/15
    1407/1407 [==============================] - 12s 8ms/step - loss: 1.0411 - accuracy: 0.6703 - val_loss: 0.7043 - val_accuracy: 0.7467
    Epoch 2/15
    1407/1407 [==============================] - 10s 7ms/step - loss: 0.5957 - accuracy: 0.7725 - val_loss: 0.5191 - val_accuracy: 0.8142
    Epoch 3/15
    1407/1407 [==============================] - 11s 8ms/step - loss: 0.4381 - accuracy: 0.8478 - val_loss: 0.4071 - val_accuracy: 0.8641
    Epoch 4/15
    1407/1407 [==============================] - 10s 7ms/step - loss: 0.3435 - accuracy: 0.8826 - val_loss: 0.3591 - val_accuracy: 0.8707
    Epoch 5/15
    1407/1407 [==============================] - 11s 7ms/step - loss: 0.3202 - accuracy: 0.8898 - val_loss: 0.3958 - val_accuracy: 0.8731
    Epoch 6/15
    1407/1407 [==============================] - 10s 7ms/step - loss: 0.2840 - accuracy: 0.8997 - val_loss: 0.4104 - val_accuracy: 0.8789
    Epoch 7/15
    1407/1407 [==============================] - 10s 7ms/step - loss: 0.2733 - accuracy: 0.9052 - val_loss: 0.3873 - val_accuracy: 0.8793
    Epoch 8/15
    1407/1407 [==============================] - 11s 8ms/step - loss: 0.2629 - accuracy: 0.9086 - val_loss: 0.3348 - val_accuracy: 0.8939
    Epoch 9/15
    1407/1407 [==============================] - 10s 7ms/step - loss: 0.2188 - accuracy: 0.9214 - val_loss: 0.3420 - val_accuracy: 0.9005
    Epoch 10/15
    1407/1407 [==============================] - 11s 7ms/step - loss: 0.2159 - accuracy: 0.9244 - val_loss: 0.3128 - val_accuracy: 0.8996
    Epoch 11/15
    1407/1407 [==============================] - 12s 9ms/step - loss: 0.2386 - accuracy: 0.9216 - val_loss: 0.3398 - val_accuracy: 0.8989
    Epoch 12/15
    1407/1407 [==============================] - 11s 8ms/step - loss: 0.2107 - accuracy: 0.9269 - val_loss: 0.3211 - val_accuracy: 0.9014
    Epoch 13/15
    1407/1407 [==============================] - 11s 7ms/step - loss: 0.2129 - accuracy: 0.9274 - val_loss: 0.3519 - val_accuracy: 0.8986
    Epoch 14/15
    1407/1407 [==============================] - 11s 8ms/step - loss: 0.3436 - accuracy: 0.9063 - val_loss: 0.4385 - val_accuracy: 0.8685
    Epoch 15/15
    1407/1407 [==============================] - 11s 8ms/step - loss: 0.2091 - accuracy: 0.9281 - val_loss: 0.3260 - val_accuracy: 0.9069



```python
plt.plot(history.history['loss'], 'b-')
plt.plot(history.history['val_loss'], 'r--')
plt.title("loss of the model")
```




    Text(0.5, 1.0, 'loss of the model')




    
![png](output_8_1.png)
    



```python
plt.plot(history.history['accuracy'], 'b-')
plt.plot(history.history['val_accuracy'], 'r--')
plt.title("accuracy of the model")
# ì •í™•ë„ê°€ ì¼ì • ìˆ˜ì¤€ì„ ë„˜ì—ˆê³  í›ˆë ¨ ëª¨ë¸ì˜ ì •í™•ë„ê°€ í…ŒìŠ¤íŠ¸ ëª¨ë¸ì˜ ì •í™•ë„ë³´ë‹¤ í¬ê²Œ ë‚˜íƒ€ë‚˜ê¸°ì— ê³¼ì†Œì í•©ì´ ì¼ì–´ ë‚˜ì§€ ì•Šì€ ì¢‹ì€ ëª¨ë¸ì´ë¼ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.
```




    Text(0.5, 1.0, 'accuracy of the model')




    
![png](output_9_1.png)
    



```python
# í›ˆë ¨ ê³¼ì •ì— ì‚¬ìš©í•˜ì§€ ì•Šì€ í…ŒìŠ¤íŠ¸ìš© ë°ì´í„°ë¡œ ëª¨ë¸ ì •í™•ë„ ì¸¡ì •
test_loss, test_acc = model.evaluate(test_images, test_labels, verbose=2)
print('í…ŒìŠ¤íŠ¸ ì •í™•ë„:', test_acc)
```

    313/313 - 1s - loss: 0.3286 - accuracy: 0.9051 - 808ms/epoch - 3ms/step
    í…ŒìŠ¤íŠ¸ ì •í™•ë„: 0.9050999879837036



```python
# í´ë˜ìŠ¤ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì •ìˆ˜ë¥¼ ë¬¸ìì—´ë¡œ ë°”ê¾¸ê¸°ìœ„í•œ ë¬¸ìì—´ ë¦¬ìŠ¤íŠ¸
class_names = ['T-shirt/top', 'Trouser', 'Pullover', 'Dress', 'Coat', 'Sandal', 'Shirt', 'Sneaker', 'Bag', 'Ankle boot']
```


```python
# 0ë¶€í„° 999ê¹Œì§€ ëœë¤ìˆ«ì
randIdx = np.random.randint(0, 1000)

# 25ê°œì˜ ì´ë¯¸ì§€ ë°ì´í„°
images = test_images[randIdx:randIdx+25]

# ê° ì˜ˆì¸¡ë³„ ê°€ì¥ í™•ë¥  ë†’ì€ ê²°ê³¼ë“¤ ë½‘ì•„ ì €ì¥
predictions = np.argmax(model.predict(images), axis=1)
# ì €ì¥ëœ ì˜ˆì¸¡ ê°’ë“¤ ì¶œë ¥
print(predictions)
```

    1/1 [==============================] - 0s 107ms/step
    [4 2 0 5 2 1 2 1 3 0 9 1 0 9 3 6 7 9 9 4 4 7 1 2 1]



```python
# ì´ë¯¸ì§€ì™€ ë ˆì´ë¸”ì„ ê° í–‰ë‹¹ 5ê°œì”© ë³´ì—¬ì£¼ëŠ” í•¨ìˆ˜ ìƒì„±
def plot_images(images, labels, images_per_row=5):
    n_images = len(images)
    # ëª‡ê°œì˜ í–‰ì¸ì§€
    n_rows = (n_images-1) // images_per_row + 1
    fig, ax = plt.subplots(n_rows, images_per_row,
                          figsize = (images_per_row * 2, n_rows * 2))
    for i in range(n_rows):
        for j in range(images_per_row):
            # ë”ì´ìƒ ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ì •ì§€
            if i*images_per_row + j >= n_images: break
            img_idx = i*images_per_row + j
            # ì´ë¯¸ì§€ë¥¼ 28,28í˜•ì‹ìœ¼ë¡œ ì¬ë°°ì¹˜
            a_image = images[img_idx].reshape(28,28)
            if n_rows>1: axis = ax[i, j]
            # í–‰ì´ 1ê°œë°–ì— ì—†ìœ¼ë©´ êµ³ì´ 2ì°¨ì›ìœ¼ë¡œ ë§Œë“¤ í•„ìš”ê°€ ì—†ê¸°ì— ì¡°ê±´ì‹ ì‚¬ìš©
            else: axis = ax[j]
            # ê·¸ë¦¼ì´ê¸°ì— xì¶• yì¶• ì•ˆë³´ì´ê²Œ ì„¤ì •
            axis.get_xaxis().set_visible(False)
            axis.get_yaxis().set_visible(False)
            # ê° ë ˆì´ë¸”ì„ ê·¸ë¦¼ ì œëª©ì— ì„¤ì •
            label = class_names[labels[img_idx]]
            axis.set_title(label)
            # ì´ì „ì— 2ì°¨ì›ìœ¼ë¡œ ë§Œë“  ê·¸ë¦¼ì„ í‘ë°±ìœ¼ë¡œ ê³ í•´ìƒë„ì˜ ë³´ê°„ë²•ì„ ì ìš©
            axis.imshow(a_image, cmap='gray', interpolation='nearest')
```


```python
# ì´ì „ì˜ í…ŒìŠ¤íŠ¸ ì´ë¯¸ì§€ 25ê°œë¥¼ ë ˆì´ë¸”ê³¼ í•¨ê»˜ ì´ë¯¸ì§€ ë³´ì—¬ì£¼ê¸°
plot_images(images, predictions, images_per_row = 5)
```


    
![png](output_14_0.png)
    



```python
# ë‚œìˆ˜ ë°œìƒê³¼ ì˜ˆì¸¡ì„ ë°˜ë³µí•˜ë©´ ë‹¤ë¥¸ ì˜ˆì¸¡ ê²°ê³¼ í™•ì¸ ê°€ëŠ¥

# 0ë¶€í„° 999ê¹Œì§€ ëœë¤ìˆ«ì
randIdx = np.random.randint(0, 1000)

num = 50

# numê°œì˜ ì´ë¯¸ì§€ ë°ì´í„°
images = test_images[randIdx:randIdx+num]

# ê° ì˜ˆì¸¡ë³„ ê°€ì¥ í™•ë¥  ë†’ì€ ê²°ê³¼ë“¤ ë½‘ì•„ ì €ì¥
predictions = np.argmax(model.predict(images), axis=1)

# ì´ì „ì˜ í…ŒìŠ¤íŠ¸ ì´ë¯¸ì§€ numê°œë¥¼ ë ˆì´ë¸”ê³¼ í•¨ê»˜ ì´ë¯¸ì§€ ë³´ì—¬ì£¼ê¸°
plot_images(images, predictions, images_per_row = 5)
```

    2/2 [==============================] - 0s 6ms/step



    
![png](output_15_1.png)
    

